# Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-06 | 1.0 | Initial architecture document | Winston (Architect) |
| 2025-10-07 | 1.1 | Add GitHub MCP server research findings | Claude (Research) |
| 2025-10-07 | 1.2 | Update to fork-based GitHub workflow | Claude (Research) |
| 2025-10-07 | 1.3 | Add Twitter/X integration decision (Direct SDK) | Claude (Research) |
| 2025-10-07 | 1.4 | Add Discord integration decision (barryyip0625/mcp-discord) | Claude (Research) |
| 2025-10-07 | 1.5 | Add Telegram integration decision (Direct Bot API) | Claude (Research) |
| 2025-10-07 | 1.6 | Complete social media research integration - all platforms researched and documented | Winston (Architect) |
| 2025-10-07 | 1.7 | Update escrow architecture: custom program replaces Squads V4 based on comprehensive research | Claude (Research) |
| 2025-10-07 | 1.8 | Add BMAD + AI SDK integration architecture section with model selection strategy and cost analysis | Claude (Research) |
| 2025-10-07 | 1.9 | Update BMAD + AI SDK section: WebSocket event architecture (not polling), add complete documentation references | Claude (Research) |
| 2025-10-07 | 2.0 | **Decentralized Infrastructure Decision**: Add Arweave + Akash Network for user-built project deployment (frontends + backends). Cost: $9 (Arweave) + $390 (Akash) = $399/mo vs. $1,300 centralized. See `docs/decentralized-infrastructure-research.md` | Claude (Research) |
| 2025-10-07 | 2.1 | **Economics Validated**: Story pricing ($2.50 minimum, $3-7 expected), staking multiples (Tier 3-4: 2x, was 1.5x/1.2x), node operator profitability (83-99% margins). See `docs/ai-infrastructure-economics-research.md` and PRD v3.2 | Claude (Economics) |
| 2025-10-07 | 2.2 | **PRD v3.2 Alignment**: Align architecture with fully autonomous PRD v3.2. Changes: (1) Update escrow split to 90/10 (removed 85/10/5), (2) Add StakeEscrow data model with tier-based multiples (5x/3x/2x), (3) Replace QAReview with AutomatedValidation model, (4) Add Infrastructure/DevOps AI agent component, (5) Add `staging_url` fields to Story and Work models, (6) Add smart contract instructions: `post_staging_url`, `submit_bid_with_stake`, `submit_automated_validation`, `slash_stake`, `increment_reputation`, (7) Add $2.50 minimum price enforcement to `create_opportunity`, (8) Update NodeRegistry with `reputation_tier`, `projects_completed`, `max_story_size_usd`, (9) Remove all human QA validator references (fully autonomous v3.0+) | BMad Master + Claude |
| 2025-10-07 | 2.3 | **Implementation Details**: Add comprehensive implementation documentation: (1) Staging URL strategy (per-story Arweave URLs vs optional custom DNS), clarify Arweave immutability creates new URL per deployment, recommend direct URLs for MVP, (2) Complete escrow fund release logic with code examples showing payment split calculation, $0.25 minimum platform fee handling, example payment calculations for $2/$3/$10 stories, (3) Update Escrow struct (192 bytes at time of v2.3), (4) Document CPI transfer flow from escrow PDA to developer and platform wallets | BMad Master + Claude |
| 2025-10-07 | 2.4 | **Git Flow + Multi-Environment Deployments**: Implement proper Git branching strategy with 3-tier deployment pipeline: (1) Add Git Flow branches (development/staging/main), (2) Story deployments → development branch → Arweave (per-story URLs), (3) Epic deployments → staging branch → Arweave (epic integration URLs), (4) Production deployments → main branch → Arweave (final product URL), (5) Add Epic data model with staging_url, story_count, completed_stories, status, (6) Update Project model with development_url, staging_url, production_url, epic_count, completed_epics, (7) Update Story model with epic_id, deployment_count, (8) Add smart contract instructions: create_epic, complete_epic, post_epic_deployment, post_production_deployment, post_story_deployment, (9) Document 3x Akash backends (dev/staging/prod, $9/month total), (10) Add token holder dashboard mockup showing all 3 deployment URLs, (11) Cost analysis: $10.80 Arweave (40 stories × 3 envs) + $9/month Akash | BMad Master + Claude |
| 2025-10-08 | 2.5 | **Infinite Tier Progression System**: Replace fixed tier system (0-4) with infinite tier progression. Add mathematical formulas: tier = floor(sqrt(projects) × successRate), stakeMultiplier = max(1.0, 5.0 × exp(-0.15 × tier)), maxStorySize = floor(5 × pow(1.4, tier)), minAbsoluteStake = floor(10 + (5 × log10(tier + 1))). Update NodeRegistry struct with calculation methods. Add smart contract functions for tier recalculation on story completion. Remove fixed tier lookup tables. Enables continuous progression (Tier 100+), unlimited story sizes ($114K+ for Tier 30), and natural market segmentation. Aligns with PRD v3.4. | BMad Master + Claude |
| 2025-10-08 | 2.6 | **QA Workflow + 3-Way Payment Split**: Align with PRD v3.5 QA workflow implementation. Changes: (1) Update Escrow struct to include QA split: add `qa_reviewer` (Pubkey) and `qa_split_bps` (u16, 500 = 5%), increase struct size from 192 to 224 bytes, (2) Update payment splits: 85% dev, 5% QA, 10% platform (was 90/10), (3) Update `approve_and_distribute()` instruction to execute 3-way transfer (developer + QA + platform), (4) Update all example calculations to show 85/5/10 split, (5) Update workflow diagrams with QA reviewer payment flows, (6) Maintain $0.25 minimum platform fee logic (unchanged). QA nodes perform automated validation and earn 5% payment on story completion. Fully autonomous validation (no human review). Aligns with PRD v3.5 (Epic Refinements + QA Workflow). | BMad Master + Claude |
| 2025-01-08 | 2.7 | **SOL→AKT Cross-Chain Swap Integration**: Add comprehensive multi-chain wallet management for Infrastructure/DevOps nodes. Primary solution: Rango Exchange aggregator (rango-sdk-basic, 1.3% fees, 95%+ success, zero KYC). Backup: THORChain/THORSwap (@xchainjs/xchain-thorchain-amm, 1.6% fees). Infrastructure node changes: (1) Add wallet structure (Solana Keypair + Cosmos mnemonic), (2) Add swap interfaces: monitorAKTBalance, shouldRefillAKT, calculateSwapAmount, swapSOLtoAKT, checkSwapStatus, logSwapCost, autoRefillAKT, (3) Add dependencies: rango-sdk-basic, @xchainjs/xchain-thorchain-amm, @cosmjs/stargate, (4) Add swap architecture diagram showing Rango→THORChain fallback, (5) Auto-refill triggers at AKT < 15 threshold (optimal balance), (6) Add cost tracking to deployment_costs table, (7) Update cost model: add ~$1/month per node for cross-chain swaps. Production-ready TypeScript examples: swap-sol-to-akt-rango.ts (376 LOC), swap-sol-to-akt-thorchain.ts (289 LOC), github-actions-auto-refill-akt.yml (automation). Comprehensive research: sol-to-akt-swap-research.md (20K words), sol-to-akt-swap-decision-brief.md (executive summary). Aligns with PRD v3.6 (Story 7.9 expanded). | Claude (Research + Implementation) |
| 2025-01-08 | 2.8 | **Configurable Auto-Refill System + Epic Renumbering**: Update swap architecture to support configurable thresholds per node operator preferences. Changes: (1) Add SwapConfig interface to InfrastructureNodeWallet with 7 configurable parameters (akt_refill_threshold, akt_target_balance, max_swap_amount_sol, slippage_tolerance_percent, check_interval_hours, primary_protocol, enable_auto_refill), (2) Update autoRefillAKT() implementation to read from config instead of hardcoded values, (3) Add updateSwapConfig() function with validation (min 5 AKT threshold, max 2.0 SOL swap limit), (4) Add config update API for node operators, (5) Document operator controls (edit via UI Story 4.13, pause auto-refill, view projected costs). Defaults: 15 AKT threshold, 22.5 AKT target (1.5x buffer), 0.5 SOL max swap, 3% slippage, 6 hour intervals, Rango primary, auto-refill enabled. Operators can customize per node needs (e.g., high-volume nodes set 30 AKT threshold). Aligns with PRD v3.7 (Epic 7 dedicated to cross-chain swap service with 10 stories, Story 8.9 references Epic 7). Epic renumbering: Former Epic 7 (Infrastructure/DevOps) → Epic 8, Epic 8 (MCP Server) → Epic 9, Epic 9 (Token Launchpad) → Epic 10, Epic 10 (Social Integration) → Epic 11. | Jonathan + Claude |

---
